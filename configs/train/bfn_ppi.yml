# Universal PPI Interface Design Training
# Using DIPS-Plus dataset for structure-conditioned sequence design

model:
  type: antibody_bfn  # Reuse the same model architecture
  res_feat_dim: 128
  pair_feat_dim: 64
  diffusion:
    num_steps: 20
    eps_net_opt:
      num_layers: 6
  train_structure: true
  train_sequence: true
  ot_opt:
    num_iters: 5

train:
  loss_weights:
    # Sequence-only design for now
    seq: 1.0
  max_iters: 200000
  val_freq: 2000
  log_freq: 200
  batch_size: 4
  seed: 2022
  max_grad_norm: 1.0
  optimizer:
    type: adam
    lr: 1.e-4
    weight_decay: 0.0
    beta1: 0.9
    beta2: 0.999
  scheduler:
    type: plateau
    factor: 0.8
    patience: 10
    min_lr: 1.e-6

dataset:
  train:
    type: dips
    data_dir: ./dips
    processed_dir: ./data/dips_processed
    split: train
    split_ratio: [0.9, 0.05, 0.05]
    transform:
    - type: mask_interface
      design_chain: ligand  # Design the ligand interface
    - type: merge_ppi_chains
      design_chain: ligand
    - type: patch_around_interface
      patch_size: 256
  val:
    type: dips
    data_dir: ./dips
    processed_dir: ./data/dips_processed
    split: val
    transform:
    - type: mask_interface
      design_chain: ligand
    - type: merge_ppi_chains
      design_chain: ligand
    - type: patch_around_interface
      patch_size: 256
